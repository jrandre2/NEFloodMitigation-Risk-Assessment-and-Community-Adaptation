{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Connected to geo_env (Python 3.9.19)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ddc7ec13-625b-4ee7-a7c1-e50d7ef76d28",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "2024-07-17 08:40:27,099 - INFO - Log file created at: /Users/jesseandrews/Library/CloudStorage/OneDrive-UniversityofNebraskaatKearney/GIS Projects/flood_zone_analysis.log\n",
      "2024-07-17 08:40:27,100 - INFO - Loading shapefiles...\n",
      "2024-07-17 08:40:27,382 - INFO - Checking and fixing geometries...\n",
      "2024-07-17 08:40:29,493 - INFO - Simplifying geometries...\n",
      "2024-07-17 08:40:34,065 - INFO - Intersecting census tracts with flood zones...\n",
      "2024-07-17 08:40:34,685 - INFO - X_AR range: 2.67 to 100.0\n",
      "2024-07-17 08:40:34,686 - WARNING - Census tracts with X_AR > 90%:\n",
      "2024-07-17 08:40:34,686 - WARNING -   Tract 31055005700: 100.0%\n",
      "2024-07-17 08:40:34,686 - WARNING -   Tract 31055005800: 100.0%\n",
      "2024-07-17 08:40:34,687 - WARNING -   Tract 31055005901: 100.0%\n",
      "2024-07-17 08:40:34,687 - WARNING -   Tract 31055006000: 100.0%\n",
      "2024-07-17 08:40:34,687 - WARNING -   Tract 31055006101: 100.0%\n",
      "2024-07-17 08:40:34,688 - WARNING -   Tract 31055006102: 99.01%\n",
      "2024-07-17 08:40:34,688 - WARNING -   Tract 31055006202: 98.34%\n",
      "2024-07-17 08:40:34,688 - WARNING -   Tract 31055006301: 100.0%\n",
      "2024-07-17 08:40:34,689 - WARNING -   Tract 31055007304: 98.38%\n",
      "2024-07-17 08:40:34,689 - WARNING -   Tract 31055007309: 100.0%\n",
      "2024-07-17 08:40:34,689 - WARNING -   Tract 31055007310: 97.68%\n",
      "2024-07-17 08:40:34,689 - WARNING -   Tract 31053964200: 93.49%\n",
      "2024-07-17 08:40:34,690 - WARNING -   Tract 31055003000: 100.0%\n",
      "2024-07-17 08:40:34,690 - WARNING -   Tract 31055003100: 100.0%\n",
      "2024-07-17 08:40:34,690 - WARNING -   Tract 31055003200: 100.0%\n",
      "2024-07-17 08:40:34,690 - WARNING -   Tract 31055003300: 100.0%\n",
      "2024-07-17 08:40:34,691 - WARNING -   Tract 31055003402: 100.0%\n",
      "2024-07-17 08:40:34,691 - WARNING -   Tract 31055003500: 100.0%\n",
      "2024-07-17 08:40:34,691 - WARNING -   Tract 31055003600: 100.0%\n",
      "2024-07-17 08:40:34,692 - WARNING -   Tract 31055003700: 100.0%\n",
      "2024-07-17 08:40:34,692 - WARNING -   Tract 31055003800: 100.0%\n",
      "2024-07-17 08:40:34,692 - WARNING -   Tract 31055004000: 100.0%\n",
      "2024-07-17 08:40:34,692 - WARNING -   Tract 31055004200: 100.0%\n",
      "2024-07-17 08:40:34,693 - WARNING -   Tract 31055004300: 100.0%\n",
      "2024-07-17 08:40:34,693 - WARNING -   Tract 31055004500: 100.0%\n",
      "2024-07-17 08:40:34,693 - WARNING -   Tract 31055004600: 95.79%\n",
      "2024-07-17 08:40:34,693 - WARNING -   Tract 31055007460: 100.0%\n",
      "2024-07-17 08:40:34,694 - WARNING -   Tract 31055004700: 100.0%\n",
      "2024-07-17 08:40:34,694 - WARNING -   Tract 31055004800: 100.0%\n",
      "2024-07-17 08:40:34,694 - WARNING -   Tract 31055004900: 100.0%\n",
      "2024-07-17 08:40:34,694 - WARNING -   Tract 31055005000: 100.0%\n",
      "2024-07-17 08:40:34,695 - WARNING -   Tract 31055005100: 100.0%\n",
      "2024-07-17 08:40:34,695 - WARNING -   Tract 31055005300: 100.0%\n",
      "2024-07-17 08:40:34,695 - WARNING -   Tract 31055005400: 100.0%\n",
      "2024-07-17 08:40:34,696 - WARNING -   Tract 31055005500: 100.0%\n",
      "2024-07-17 08:40:34,696 - WARNING -   Tract 31055007317: 90.19%\n",
      "2024-07-17 08:40:34,696 - WARNING -   Tract 31055007314: 99.62%\n",
      "2024-07-17 08:40:34,696 - WARNING -   Tract 31055007470: 97.58%\n",
      "2024-07-17 08:40:34,697 - WARNING -   Tract 31055007516: 100.0%\n",
      "2024-07-17 08:40:34,697 - WARNING -   Tract 31055007316: 93.48%\n",
      "2024-07-17 08:40:34,697 - WARNING -   Tract 31055007512: 91.27%\n",
      "2024-07-17 08:40:34,697 - WARNING -   Tract 31055007513: 100.0%\n",
      "2024-07-17 08:40:34,698 - WARNING -   Tract 31055007469: 96.92%\n",
      "2024-07-17 08:40:34,698 - WARNING -   Tract 31055007471: 90.88%\n",
      "2024-07-17 08:40:34,699 - WARNING -   Tract 31055007517: 100.0%\n",
      "2024-07-17 08:40:34,699 - WARNING -   Tract 31055007511: 97.84%\n",
      "2024-07-17 08:40:34,699 - WARNING -   Tract 31055007514: 100.0%\n",
      "2024-07-17 08:40:34,700 - WARNING -   Tract 31055007515: 98.68%\n",
      "2024-07-17 08:40:34,700 - WARNING -   Tract 31153010622: 99.85%\n",
      "2024-07-17 08:40:34,700 - WARNING -   Tract 31155968200: 90.85%\n",
      "2024-07-17 08:40:34,701 - WARNING -   Tract 31055007431: 100.0%\n",
      "2024-07-17 08:40:34,701 - WARNING -   Tract 31055007311: 100.0%\n",
      "2024-07-17 08:40:34,701 - WARNING -   Tract 31055002100: 100.0%\n",
      "2024-07-17 08:40:34,702 - WARNING -   Tract 31055004400: 100.0%\n",
      "2024-07-17 08:40:34,702 - WARNING -   Tract 31055007438: 100.0%\n",
      "2024-07-17 08:40:34,702 - WARNING -   Tract 31055003401: 100.0%\n",
      "2024-07-17 08:40:34,703 - WARNING -   Tract 31055005200: 100.0%\n",
      "2024-07-17 08:40:34,703 - WARNING -   Tract 31055006303: 100.0%\n",
      "2024-07-17 08:40:34,703 - WARNING -   Tract 31055006302: 100.0%\n",
      "2024-07-17 08:40:34,703 - WARNING -   Tract 31055006400: 100.0%\n",
      "2024-07-17 08:40:34,704 - WARNING -   Tract 31055007312: 92.76%\n",
      "2024-07-17 08:40:34,704 - WARNING -   Tract 31055007313: 95.85%\n",
      "2024-07-17 08:40:34,705 - WARNING -   Tract 31055007405: 99.42%\n",
      "2024-07-17 08:40:34,705 - WARNING -   Tract 31055007406: 98.31%\n",
      "2024-07-17 08:40:34,705 - WARNING -   Tract 31055007407: 96.45%\n",
      "2024-07-17 08:40:34,706 - WARNING -   Tract 31055007408: 95.82%\n",
      "2024-07-17 08:40:34,706 - WARNING -   Tract 31055007409: 92.1%\n",
      "2024-07-17 08:40:34,706 - WARNING -   Tract 31055007424: 100.0%\n",
      "2024-07-17 08:40:34,707 - WARNING -   Tract 31055007429: 99.41%\n",
      "2024-07-17 08:40:34,707 - WARNING -   Tract 31055007434: 100.0%\n",
      "2024-07-17 08:40:34,708 - WARNING -   Tract 31055007456: 95.19%\n",
      "2024-07-17 08:40:34,708 - WARNING -   Tract 31055007457: 99.97%\n",
      "2024-07-17 08:40:34,709 - WARNING -   Tract 31055007458: 100.0%\n",
      "2024-07-17 08:40:34,709 - WARNING -   Tract 31055007461: 100.0%\n",
      "2024-07-17 08:40:34,709 - WARNING -   Tract 31055007462: 100.0%\n",
      "2024-07-17 08:40:34,710 - WARNING -   Tract 31055007463: 91.47%\n",
      "2024-07-17 08:40:34,711 - WARNING -   Tract 31055007442: 100.0%\n",
      "2024-07-17 08:40:34,711 - WARNING -   Tract 31055007443: 100.0%\n",
      "2024-07-17 08:40:34,714 - WARNING -   Tract 31153010617: 90.94%\n",
      "2024-07-17 08:40:34,717 - WARNING -   Tract 31055007465: 97.05%\n",
      "2024-07-17 08:40:34,718 - WARNING -   Tract 31055007466: 100.0%\n",
      "2024-07-17 08:40:34,719 - WARNING -   Tract 31055007467: 100.0%\n",
      "2024-07-17 08:40:34,720 - WARNING -   Tract 31055007509: 95.2%\n",
      "2024-07-17 08:40:34,720 - WARNING -   Tract 31055003900: 100.0%\n",
      "2024-07-17 08:40:34,720 - WARNING -   Tract 31177050101: 97.4%\n",
      "2024-07-17 08:40:34,721 - WARNING -   Tract 31055007472: 100.0%\n",
      "2024-07-17 08:40:34,721 - WARNING -   Tract 31153010629: 93.91%\n",
      "2024-07-17 08:40:34,721 - WARNING -   Tract 31153010624: 93.93%\n",
      "2024-07-17 08:40:34,722 - WARNING -   Tract 31153010628: 90.69%\n",
      "2024-07-17 08:40:34,722 - WARNING -   Tract 31153010630: 99.06%\n",
      "2024-07-17 08:40:34,722 - WARNING -   Tract 31153010634: 100.0%\n",
      "2024-07-17 08:40:34,723 - WARNING -   Tract 31153010621: 100.0%\n",
      "2024-07-17 08:40:34,723 - WARNING -   Tract 31153010632: 97.56%\n",
      "2024-07-17 08:40:34,724 - WARNING -   Tract 31055005902: 100.0%\n",
      "2024-07-17 08:40:34,724 - WARNING -   Tract 31055007468: 96.89%\n",
      "2024-07-17 08:40:34,724 - WARNING -   Tract 31055006503: 94.73%\n",
      "2024-07-17 08:40:34,725 - WARNING -   Tract 31055006504: 94.29%\n",
      "2024-07-17 08:40:34,725 - WARNING -   Tract 31055006505: 99.37%\n",
      "2024-07-17 08:40:34,726 - WARNING -   Tract 31055006506: 95.24%\n",
      "2024-07-17 08:40:34,726 - WARNING -   Tract 31055006602: 95.25%\n",
      "2024-07-17 08:40:34,726 - WARNING -   Tract 31055007445: 99.68%\n",
      "2024-07-17 08:40:34,726 - WARNING -   Tract 31055007447: 100.0%\n",
      "2024-07-17 08:40:34,727 - WARNING -   Tract 31055007448: 100.0%\n",
      "2024-07-17 08:40:34,727 - WARNING -   Tract 31055007449: 100.0%\n",
      "2024-07-17 08:40:34,727 - WARNING -   Tract 31055007450: 90.18%\n",
      "2024-07-17 08:40:34,728 - WARNING -   Tract 31055007454: 92.85%\n",
      "2024-07-17 08:40:34,728 - WARNING -   Tract 31055000300: 100.0%\n",
      "2024-07-17 08:40:34,728 - WARNING -   Tract 31055000400: 95.15%\n",
      "2024-07-17 08:40:34,728 - WARNING -   Tract 31055006701: 90.78%\n",
      "2024-07-17 08:40:34,729 - WARNING -   Tract 31055006704: 95.63%\n",
      "2024-07-17 08:40:34,729 - WARNING -   Tract 31055006803: 100.0%\n",
      "2024-07-17 08:40:34,729 - WARNING -   Tract 31055007435: 100.0%\n",
      "2024-07-17 08:40:34,730 - WARNING -   Tract 31055007436: 96.07%\n",
      "2024-07-17 08:40:34,730 - WARNING -   Tract 31055007440: 91.26%\n",
      "2024-07-17 08:40:34,730 - WARNING -   Tract 31055000600: 100.0%\n",
      "2024-07-17 08:40:34,731 - WARNING -   Tract 31055000700: 100.0%\n",
      "2024-07-17 08:40:34,731 - WARNING -   Tract 31055000800: 100.0%\n",
      "2024-07-17 08:40:34,731 - WARNING -   Tract 31055001100: 100.0%\n",
      "2024-07-17 08:40:34,732 - WARNING -   Tract 31055001200: 100.0%\n",
      "2024-07-17 08:40:34,732 - WARNING -   Tract 31055001600: 100.0%\n",
      "2024-07-17 08:40:34,732 - WARNING -   Tract 31055001800: 93.69%\n",
      "2024-07-17 08:40:34,733 - WARNING -   Tract 31055001900: 100.0%\n",
      "2024-07-17 08:40:34,733 - WARNING -   Tract 31055002000: 100.0%\n",
      "2024-07-17 08:40:34,733 - WARNING -   Tract 31055006806: 100.0%\n",
      "2024-07-17 08:40:34,734 - WARNING -   Tract 31055006903: 100.0%\n",
      "2024-07-17 08:40:34,734 - WARNING -   Tract 31055006904: 99.05%\n",
      "2024-07-17 08:40:34,734 - WARNING -   Tract 31055007002: 100.0%\n",
      "2024-07-17 08:40:34,734 - WARNING -   Tract 31055002400: 100.0%\n",
      "2024-07-17 08:40:34,735 - WARNING -   Tract 31055002600: 100.0%\n",
      "2024-07-17 08:40:34,735 - WARNING -   Tract 31055002900: 100.0%\n",
      "2024-07-17 08:40:34,735 - WARNING -   Tract 31055007003: 92.83%\n",
      "2024-07-17 08:40:34,736 - WARNING -   Tract 31153010401: 97.22%\n",
      "2024-07-17 08:40:34,736 - WARNING -   Tract 31153010501: 91.61%\n",
      "2024-07-17 08:40:34,736 - WARNING -   Tract 31153010203: 96.0%\n",
      "2024-07-17 08:40:34,736 - WARNING -   Tract 31053963900: 99.98%\n",
      "2024-07-17 08:40:34,737 - WARNING -   Tract 31053964000: 100.0%\n",
      "2024-07-17 08:40:34,737 - WARNING -   Tract 31153010104: 97.26%\n",
      "2024-07-17 08:40:34,737 - WARNING -   Tract 31153010107: 98.07%\n",
      "2024-07-17 08:40:34,737 - WARNING -   Tract 31153010105: 97.47%\n",
      "2024-07-17 08:40:34,738 - WARNING -   Tract 31153010614: 95.75%\n",
      "2024-07-17 08:40:34,738 - WARNING -   Tract 31153010205: 100.0%\n",
      "2024-07-17 08:40:34,738 - WARNING -   Tract 31153010206: 95.93%\n",
      "2024-07-17 08:40:34,739 - WARNING -   Tract 31053964100: 96.05%\n",
      "2024-07-17 08:40:34,744 - INFO - AE_AR range: 0.0 to 88.12\n",
      "2024-07-17 08:40:34,746 - INFO - A_AR range: 0.0 to 15.3\n",
      "2024-07-17 08:40:34,748 - INFO - AO_AR range: 0.0 to 38.94\n",
      "2024-07-17 08:40:34,751 - INFO - AH_AR range: 0.0 to 13.55\n",
      "2024-07-17 08:40:34,753 - INFO - Total flood zone percentage range: 96.67 to 100.0\n",
      "2024-07-17 08:40:34,754 - WARNING - Census tracts with total flood zone percentage > 90%:\n",
      "2024-07-17 08:40:34,755 - WARNING -   Tract 31055005700: 100.0%\n",
      "2024-07-17 08:40:34,755 - WARNING -   Tract 31055005800: 100.0%\n",
      "2024-07-17 08:40:34,756 - WARNING -   Tract 31055005901: 100.0%\n",
      "2024-07-17 08:40:34,756 - WARNING -   Tract 31055006000: 100.0%\n",
      "2024-07-17 08:40:34,756 - WARNING -   Tract 31055006101: 100.0%\n",
      "2024-07-17 08:40:34,757 - WARNING -   Tract 31055006102: 100.0%\n",
      "2024-07-17 08:40:34,758 - WARNING -   Tract 31055006202: 100.0%\n",
      "2024-07-17 08:40:34,758 - WARNING -   Tract 31055006301: 100.0%\n",
      "2024-07-17 08:40:34,759 - WARNING -   Tract 31055007303: 99.79%\n",
      "2024-07-17 08:40:34,759 - WARNING -   Tract 31055007304: 100.0%\n",
      "2024-07-17 08:40:34,759 - WARNING -   Tract 31055007309: 100.0%\n",
      "2024-07-17 08:40:34,760 - WARNING -   Tract 31055007310: 100.0%\n",
      "2024-07-17 08:40:34,761 - WARNING -   Tract 31053964300: 100.0%\n",
      "2024-07-17 08:40:34,761 - WARNING -   Tract 31053964200: 100.0%\n",
      "2024-07-17 08:40:34,762 - WARNING -   Tract 31055003000: 100.0%\n",
      "2024-07-17 08:40:34,762 - WARNING -   Tract 31055003100: 100.0%\n",
      "2024-07-17 08:40:34,762 - WARNING -   Tract 31055003200: 100.0%\n",
      "2024-07-17 08:40:34,762 - WARNING -   Tract 31055003300: 100.0%\n",
      "2024-07-17 08:40:34,763 - WARNING -   Tract 31055003402: 100.0%\n",
      "2024-07-17 08:40:34,763 - WARNING -   Tract 31055003500: 100.0%\n",
      "2024-07-17 08:40:34,763 - WARNING -   Tract 31055003600: 100.0%\n",
      "2024-07-17 08:40:34,764 - WARNING -   Tract 31055003700: 100.0%\n",
      "2024-07-17 08:40:34,764 - WARNING -   Tract 31055003800: 100.0%\n",
      "2024-07-17 08:40:34,764 - WARNING -   Tract 31055004000: 100.0%\n",
      "2024-07-17 08:40:34,765 - WARNING -   Tract 31055004200: 100.0%\n",
      "2024-07-17 08:40:34,765 - WARNING -   Tract 31055004300: 100.0%\n",
      "2024-07-17 08:40:34,765 - WARNING -   Tract 31055004500: 100.0%\n",
      "2024-07-17 08:40:34,765 - WARNING -   Tract 31055004600: 100.0%\n",
      "2024-07-17 08:40:34,766 - WARNING -   Tract 31055007102: 100.0%\n",
      "2024-07-17 08:40:34,766 - WARNING -   Tract 31055007460: 100.0%\n",
      "2024-07-17 08:40:34,766 - WARNING -   Tract 31055004700: 100.0%\n",
      "2024-07-17 08:40:34,767 - WARNING -   Tract 31055004800: 100.0%\n",
      "2024-07-17 08:40:34,767 - WARNING -   Tract 31055004900: 100.0%\n",
      "2024-07-17 08:40:34,767 - WARNING -   Tract 31055005000: 100.0%\n",
      "2024-07-17 08:40:34,768 - WARNING -   Tract 31055005100: 100.0%\n",
      "2024-07-17 08:40:34,768 - WARNING -   Tract 31055005300: 100.0%\n",
      "2024-07-17 08:40:34,768 - WARNING -   Tract 31055005400: 100.0%\n",
      "2024-07-17 08:40:34,769 - WARNING -   Tract 31055005500: 100.0%\n",
      "2024-07-17 08:40:34,769 - WARNING -   Tract 31055005600: 100.0%\n",
      "2024-07-17 08:40:34,769 - WARNING -   Tract 31055007317: 100.0%\n",
      "2024-07-17 08:40:34,770 - WARNING -   Tract 31055007314: 100.0%\n",
      "2024-07-17 08:40:34,770 - WARNING -   Tract 31055007470: 100.0%\n",
      "2024-07-17 08:40:34,770 - WARNING -   Tract 31055007516: 100.0%\n",
      "2024-07-17 08:40:34,771 - WARNING -   Tract 31055007315: 100.0%\n",
      "2024-07-17 08:40:34,771 - WARNING -   Tract 31055007318: 100.0%\n",
      "2024-07-17 08:40:34,771 - WARNING -   Tract 31055007316: 100.0%\n",
      "2024-07-17 08:40:34,772 - WARNING -   Tract 31055007512: 100.0%\n",
      "2024-07-17 08:40:34,773 - WARNING -   Tract 31055007513: 100.0%\n",
      "2024-07-17 08:40:34,773 - WARNING -   Tract 31055007469: 100.0%\n",
      "2024-07-17 08:40:34,774 - WARNING -   Tract 31055007471: 100.0%\n",
      "2024-07-17 08:40:34,774 - WARNING -   Tract 31055007517: 100.0%\n",
      "2024-07-17 08:40:34,774 - WARNING -   Tract 31055007511: 100.0%\n",
      "2024-07-17 08:40:34,775 - WARNING -   Tract 31055007514: 100.0%\n",
      "2024-07-17 08:40:34,775 - WARNING -   Tract 31055007515: 100.0%\n",
      "2024-07-17 08:40:34,775 - WARNING -   Tract 31153010622: 100.0%\n",
      "2024-07-17 08:40:34,776 - WARNING -   Tract 31155968500: 99.87%\n",
      "2024-07-17 08:40:34,776 - WARNING -   Tract 31155968300: 100.0%\n",
      "2024-07-17 08:40:34,776 - WARNING -   Tract 31155968200: 99.95%\n",
      "2024-07-17 08:40:34,777 - WARNING -   Tract 31155968400: 100.0%\n",
      "2024-07-17 08:40:34,777 - WARNING -   Tract 31155968100: 100.0%\n",
      "2024-07-17 08:40:34,778 - WARNING -   Tract 31055000500: 97.6%\n",
      "2024-07-17 08:40:34,778 - WARNING -   Tract 31055006805: 100.0%\n",
      "2024-07-17 08:40:34,778 - WARNING -   Tract 31055000200: 99.99%\n",
      "2024-07-17 08:40:34,778 - WARNING -   Tract 31055007431: 100.0%\n",
      "2024-07-17 08:40:34,779 - WARNING -   Tract 31055007311: 100.0%\n",
      "2024-07-17 08:40:34,779 - WARNING -   Tract 31055002100: 100.0%\n",
      "2024-07-17 08:40:34,779 - WARNING -   Tract 31055004400: 100.0%\n",
      "2024-07-17 08:40:34,780 - WARNING -   Tract 31055007438: 100.0%\n",
      "2024-07-17 08:40:34,780 - WARNING -   Tract 31055006703: 100.0%\n",
      "2024-07-17 08:40:34,780 - WARNING -   Tract 31055003401: 100.0%\n",
      "2024-07-17 08:40:34,781 - WARNING -   Tract 31055005200: 100.0%\n",
      "2024-07-17 08:40:34,781 - WARNING -   Tract 31055006303: 100.0%\n",
      "2024-07-17 08:40:34,782 - WARNING -   Tract 31055006302: 100.0%\n",
      "2024-07-17 08:40:34,782 - WARNING -   Tract 31055006400: 100.0%\n",
      "2024-07-17 08:40:34,782 - WARNING -   Tract 31055007312: 100.0%\n",
      "2024-07-17 08:40:34,783 - WARNING -   Tract 31055007313: 100.0%\n",
      "2024-07-17 08:40:34,783 - WARNING -   Tract 31055007405: 100.0%\n",
      "2024-07-17 08:40:34,783 - WARNING -   Tract 31055007406: 100.0%\n",
      "2024-07-17 08:40:34,784 - WARNING -   Tract 31055007407: 100.0%\n",
      "2024-07-17 08:40:34,784 - WARNING -   Tract 31055007408: 100.0%\n",
      "2024-07-17 08:40:34,784 - WARNING -   Tract 31055007409: 100.0%\n",
      "2024-07-17 08:40:34,785 - WARNING -   Tract 31055007424: 100.0%\n",
      "2024-07-17 08:40:34,785 - WARNING -   Tract 31055007429: 100.0%\n",
      "2024-07-17 08:40:34,785 - WARNING -   Tract 31055007432: 100.0%\n",
      "2024-07-17 08:40:34,786 - WARNING -   Tract 31055007433: 100.0%\n",
      "2024-07-17 08:40:34,786 - WARNING -   Tract 31055007434: 100.0%\n",
      "2024-07-17 08:40:34,786 - WARNING -   Tract 31055007456: 100.0%\n",
      "2024-07-17 08:40:34,786 - WARNING -   Tract 31055007457: 100.0%\n",
      "2024-07-17 08:40:34,787 - WARNING -   Tract 31055007458: 100.0%\n",
      "2024-07-17 08:40:34,787 - WARNING -   Tract 31055007459: 100.0%\n",
      "2024-07-17 08:40:34,787 - WARNING -   Tract 31055007461: 100.0%\n",
      "2024-07-17 08:40:34,788 - WARNING -   Tract 31055007462: 100.0%\n",
      "2024-07-17 08:40:34,788 - WARNING -   Tract 31055007463: 100.0%\n",
      "2024-07-17 08:40:34,789 - WARNING -   Tract 31055007464: 100.0%\n",
      "2024-07-17 08:40:34,789 - WARNING -   Tract 31055007442: 100.0%\n",
      "2024-07-17 08:40:34,790 - WARNING -   Tract 31055007443: 100.0%\n",
      "2024-07-17 08:40:34,790 - WARNING -   Tract 31153010623: 100.0%\n",
      "2024-07-17 08:40:34,791 - WARNING -   Tract 31153010615: 100.0%\n",
      "2024-07-17 08:40:34,791 - WARNING -   Tract 31153010619: 100.0%\n",
      "2024-07-17 08:40:34,792 - WARNING -   Tract 31153010616: 100.0%\n",
      "2024-07-17 08:40:34,792 - WARNING -   Tract 31153010617: 100.0%\n",
      "2024-07-17 08:40:34,793 - WARNING -   Tract 31153010620: 100.0%\n",
      "2024-07-17 08:40:34,793 - WARNING -   Tract 31153010618: 100.0%\n",
      "2024-07-17 08:40:34,794 - WARNING -   Tract 31055007465: 100.0%\n",
      "2024-07-17 08:40:34,794 - WARNING -   Tract 31055007466: 100.0%\n",
      "2024-07-17 08:40:34,794 - WARNING -   Tract 31055007467: 100.0%\n",
      "2024-07-17 08:40:34,795 - WARNING -   Tract 31055007504: 100.0%\n",
      "2024-07-17 08:40:34,795 - WARNING -   Tract 31055007506: 100.0%\n",
      "2024-07-17 08:40:34,795 - WARNING -   Tract 31055007509: 100.0%\n",
      "2024-07-17 08:40:34,796 - WARNING -   Tract 31055003900: 100.0%\n",
      "2024-07-17 08:40:34,796 - WARNING -   Tract 31177050202: 99.65%\n",
      "2024-07-17 08:40:34,796 - WARNING -   Tract 31177050102: 100.0%\n",
      "2024-07-17 08:40:34,797 - WARNING -   Tract 31177050300: 99.98%\n",
      "2024-07-17 08:40:34,797 - WARNING -   Tract 31177050201: 100.0%\n",
      "2024-07-17 08:40:34,797 - WARNING -   Tract 31177050101: 100.0%\n",
      "2024-07-17 08:40:34,797 - WARNING -   Tract 31153010503: 100.0%\n",
      "2024-07-17 08:40:34,798 - WARNING -   Tract 31055007472: 100.0%\n",
      "2024-07-17 08:40:34,798 - WARNING -   Tract 31153010207: 100.0%\n",
      "2024-07-17 08:40:34,798 - WARNING -   Tract 31055007452: 100.0%\n",
      "2024-07-17 08:40:34,799 - WARNING -   Tract 31153010204: 100.0%\n",
      "2024-07-17 08:40:34,799 - WARNING -   Tract 31153010306: 100.0%\n",
      "2024-07-17 08:40:34,799 - WARNING -   Tract 31153010305: 100.0%\n",
      "2024-07-17 08:40:34,800 - WARNING -   Tract 31153010629: 100.0%\n",
      "2024-07-17 08:40:34,800 - WARNING -   Tract 31153010624: 100.0%\n",
      "2024-07-17 08:40:34,800 - WARNING -   Tract 31153010628: 100.0%\n",
      "2024-07-17 08:40:34,800 - WARNING -   Tract 31153010633: 100.0%\n",
      "2024-07-17 08:40:34,801 - WARNING -   Tract 31153010627: 99.99%\n",
      "2024-07-17 08:40:34,801 - WARNING -   Tract 31153010630: 100.0%\n",
      "2024-07-17 08:40:34,802 - WARNING -   Tract 31153010634: 100.0%\n",
      "2024-07-17 08:40:34,802 - WARNING -   Tract 31153010621: 100.0%\n",
      "2024-07-17 08:40:34,803 - WARNING -   Tract 31153010625: 100.0%\n",
      "2024-07-17 08:40:34,804 - WARNING -   Tract 31153010626: 100.0%\n",
      "2024-07-17 08:40:34,804 - WARNING -   Tract 31153010632: 100.0%\n",
      "2024-07-17 08:40:34,805 - WARNING -   Tract 31153010631: 100.0%\n",
      "2024-07-17 08:40:34,805 - WARNING -   Tract 31055007508: 100.0%\n",
      "2024-07-17 08:40:34,806 - WARNING -   Tract 31055006804: 100.0%\n",
      "2024-07-17 08:40:34,806 - WARNING -   Tract 31055005902: 100.0%\n",
      "2024-07-17 08:40:34,807 - WARNING -   Tract 31055007441: 100.0%\n",
      "2024-07-17 08:40:34,807 - WARNING -   Tract 31055007505: 100.0%\n",
      "2024-07-17 08:40:34,808 - WARNING -   Tract 31055007451: 100.0%\n",
      "2024-07-17 08:40:34,808 - WARNING -   Tract 31055007468: 99.99%\n",
      "2024-07-17 08:40:34,809 - WARNING -   Tract 31055007101: 100.0%\n",
      "2024-07-17 08:40:34,809 - WARNING -   Tract 31055006503: 100.0%\n",
      "2024-07-17 08:40:34,809 - WARNING -   Tract 31055006504: 100.0%\n",
      "2024-07-17 08:40:34,809 - WARNING -   Tract 31055006505: 100.0%\n",
      "2024-07-17 08:40:34,810 - WARNING -   Tract 31055006506: 100.0%\n",
      "2024-07-17 08:40:34,810 - WARNING -   Tract 31055006602: 100.0%\n",
      "2024-07-17 08:40:34,811 - WARNING -   Tract 31055006603: 100.0%\n",
      "2024-07-17 08:40:34,811 - WARNING -   Tract 31055007444: 100.0%\n",
      "2024-07-17 08:40:34,812 - WARNING -   Tract 31055007445: 100.0%\n",
      "2024-07-17 08:40:34,812 - WARNING -   Tract 31055007446: 100.0%\n",
      "2024-07-17 08:40:34,813 - WARNING -   Tract 31055007447: 100.0%\n",
      "2024-07-17 08:40:34,813 - WARNING -   Tract 31055007448: 100.0%\n",
      "2024-07-17 08:40:34,813 - WARNING -   Tract 31055007449: 100.0%\n",
      "2024-07-17 08:40:34,814 - WARNING -   Tract 31055007450: 99.99%\n",
      "2024-07-17 08:40:34,814 - WARNING -   Tract 31055007453: 100.0%\n",
      "2024-07-17 08:40:34,814 - WARNING -   Tract 31055007455: 100.0%\n",
      "2024-07-17 08:40:34,815 - WARNING -   Tract 31055007454: 100.0%\n",
      "2024-07-17 08:40:34,815 - WARNING -   Tract 31055000300: 100.0%\n",
      "2024-07-17 08:40:34,815 - WARNING -   Tract 31055000400: 100.0%\n",
      "2024-07-17 08:40:34,816 - WARNING -   Tract 31055006604: 100.0%\n",
      "2024-07-17 08:40:34,816 - WARNING -   Tract 31055006701: 100.0%\n",
      "2024-07-17 08:40:34,816 - WARNING -   Tract 31055006704: 100.0%\n",
      "2024-07-17 08:40:34,816 - WARNING -   Tract 31055006803: 100.0%\n",
      "2024-07-17 08:40:34,817 - WARNING -   Tract 31055007435: 100.0%\n",
      "2024-07-17 08:40:34,817 - WARNING -   Tract 31055007436: 100.0%\n",
      "2024-07-17 08:40:34,817 - WARNING -   Tract 31055007439: 100.0%\n",
      "2024-07-17 08:40:34,818 - WARNING -   Tract 31055007440: 100.0%\n",
      "2024-07-17 08:40:34,818 - WARNING -   Tract 31055000600: 100.0%\n",
      "2024-07-17 08:40:34,818 - WARNING -   Tract 31055000700: 100.0%\n",
      "2024-07-17 08:40:34,819 - WARNING -   Tract 31055000800: 100.0%\n",
      "2024-07-17 08:40:34,819 - WARNING -   Tract 31055001100: 100.0%\n",
      "2024-07-17 08:40:34,819 - WARNING -   Tract 31055001200: 100.0%\n",
      "2024-07-17 08:40:34,819 - WARNING -   Tract 31055001600: 100.0%\n",
      "2024-07-17 08:40:34,820 - WARNING -   Tract 31055001800: 99.8%\n",
      "2024-07-17 08:40:34,820 - WARNING -   Tract 31055001900: 100.0%\n",
      "2024-07-17 08:40:34,821 - WARNING -   Tract 31055002000: 100.0%\n",
      "2024-07-17 08:40:34,821 - WARNING -   Tract 31055006806: 100.0%\n",
      "2024-07-17 08:40:34,821 - WARNING -   Tract 31055006903: 100.0%\n",
      "2024-07-17 08:40:34,823 - WARNING -   Tract 31055006904: 100.0%\n",
      "2024-07-17 08:40:34,824 - WARNING -   Tract 31055006905: 100.0%\n",
      "2024-07-17 08:40:34,824 - WARNING -   Tract 31055006906: 100.0%\n",
      "2024-07-17 08:40:34,825 - WARNING -   Tract 31055007001: 100.0%\n",
      "2024-07-17 08:40:34,825 - WARNING -   Tract 31055007002: 100.0%\n",
      "2024-07-17 08:40:34,825 - WARNING -   Tract 31055002200: 97.99%\n",
      "2024-07-17 08:40:34,825 - WARNING -   Tract 31055002300: 96.67%\n",
      "2024-07-17 08:40:34,826 - WARNING -   Tract 31055002400: 100.0%\n",
      "2024-07-17 08:40:34,826 - WARNING -   Tract 31055002500: 99.45%\n",
      "2024-07-17 08:40:34,826 - WARNING -   Tract 31055002600: 100.0%\n",
      "2024-07-17 08:40:34,827 - WARNING -   Tract 31055002700: 100.0%\n",
      "2024-07-17 08:40:34,827 - WARNING -   Tract 31055002800: 99.96%\n",
      "2024-07-17 08:40:34,827 - WARNING -   Tract 31055002900: 100.0%\n",
      "2024-07-17 08:40:34,828 - WARNING -   Tract 31055007003: 100.0%\n",
      "2024-07-17 08:40:34,828 - WARNING -   Tract 31153010401: 100.0%\n",
      "2024-07-17 08:40:34,828 - WARNING -   Tract 31153010402: 99.96%\n",
      "2024-07-17 08:40:34,829 - WARNING -   Tract 31153010501: 100.0%\n",
      "2024-07-17 08:40:34,829 - WARNING -   Tract 31153010502: 100.0%\n",
      "2024-07-17 08:40:34,829 - WARNING -   Tract 31153010108: 100.0%\n",
      "2024-07-17 08:40:34,830 - WARNING -   Tract 31153010203: 100.0%\n",
      "2024-07-17 08:40:34,830 - WARNING -   Tract 31053963900: 100.0%\n",
      "2024-07-17 08:40:34,830 - WARNING -   Tract 31053963600: 99.95%\n",
      "2024-07-17 08:40:34,831 - WARNING -   Tract 31053964000: 100.0%\n",
      "2024-07-17 08:40:34,832 - WARNING -   Tract 31053963700: 100.0%\n",
      "2024-07-17 08:40:34,832 - WARNING -   Tract 31053964400: 100.0%\n",
      "2024-07-17 08:40:34,832 - WARNING -   Tract 31053963800: 100.0%\n",
      "2024-07-17 08:40:34,833 - WARNING -   Tract 31153010208: 99.8%\n",
      "2024-07-17 08:40:34,833 - WARNING -   Tract 31153010702: 99.91%\n",
      "2024-07-17 08:40:34,834 - WARNING -   Tract 31153010104: 100.0%\n",
      "2024-07-17 08:40:34,834 - WARNING -   Tract 31153010107: 100.0%\n",
      "2024-07-17 08:40:34,834 - WARNING -   Tract 31153010103: 98.81%\n",
      "2024-07-17 08:40:34,835 - WARNING -   Tract 31153010105: 100.0%\n",
      "2024-07-17 08:40:34,835 - WARNING -   Tract 31153010701: 99.58%\n",
      "2024-07-17 08:40:34,835 - WARNING -   Tract 31153010302: 100.0%\n",
      "2024-07-17 08:40:34,836 - WARNING -   Tract 31153010106: 99.95%\n",
      "2024-07-17 08:40:34,836 - WARNING -   Tract 31153010614: 100.0%\n",
      "2024-07-17 08:40:34,836 - WARNING -   Tract 31153010205: 100.0%\n",
      "2024-07-17 08:40:34,837 - WARNING -   Tract 31153010206: 100.0%\n",
      "2024-07-17 08:40:34,837 - WARNING -   Tract 31053964100: 100.0%\n",
      "2024-07-17 08:40:34,838 - INFO - Saving updated shapefile to /Users/jesseandrews/Library/CloudStorage/OneDrive-UniversityofNebraskaatKearney/GIS Projects/Study_Area_ACS/ACS_Census_Tracts_Updated.shp\n",
      "<ipython-input-1-7d4b1ae8a348>:113: UserWarning: Column names longer than 10 characters will be truncated when saved to ESRI Shapefile.\n",
      "  census_tracts.to_file(census_tracts_path)\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Normalized/laundered field name: 'TOTAL_FZ_AR' to 'TOTAL_FZ_A'\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 942208004 of field ALAND of feature 57 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 515647587 of field ALAND of feature 58 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 378770796 of field ALAND of feature 59 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 106311917 of field ALAND of feature 106 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 140354656 of field ALAND of feature 110 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 585403628 of field ALAND of feature 112 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 215624574 of field ALAND of feature 113 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 587389190 of field ALAND of feature 200 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 602315990 of field ALAND of feature 202 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 133272780 of field ALAND of feature 204 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "/opt/anaconda3/envs/geo_env/lib/python3.9/site-packages/pyogrio/raw.py:709: RuntimeWarning: Value 184199587 of field ALAND of feature 211 not successfully written. Possibly due to too larger number with respect to field width\n",
      "  ogr_write(\n",
      "2024-07-17 08:40:34,861 - INFO - Created 218 records\n",
      "2024-07-17 08:40:34,862 - INFO - Processing complete!\n"
     ]
    }
   ],
   "source": [
    "import geopandas as gpd\n",
    "import pandas as pd\n",
    "from pyproj import CRS\n",
    "import logging\n",
    "import os\n",
    "from shapely.validation import make_valid\n",
    "\n",
    "# Set up logging\n",
    "log_file_path = \"/Users/jesseandrews/Library/CloudStorage/OneDrive-UniversityofNebraskaatKearney/GIS Projects/flood_zone_analysis.log\"\n",
    "logging.basicConfig(\n",
    "    level=logging.DEBUG,\n",
    "    format='%(asctime)s - %(levelname)s - %(message)s',\n",
    "    filename=log_file_path,\n",
    "    filemode='w'  # 'w' mode overwrites the file each time the script runs\n",
    ")\n",
    "\n",
    "# Add a stream handler to also log to console\n",
    "console = logging.StreamHandler()\n",
    "console.setLevel(logging.INFO)\n",
    "formatter = logging.Formatter('%(asctime)s - %(levelname)s - %(message)s')\n",
    "console.setFormatter(formatter)\n",
    "logging.getLogger('').addHandler(console)\n",
    "\n",
    "logging.info(f\"Log file created at: {log_file_path}\")\n",
    "\n",
    "# File paths\n",
    "census_tracts_path = \"/Users/jesseandrews/Library/CloudStorage/OneDrive-UniversityofNebraskaatKearney/GIS Projects/Study_Area_ACS/ACS_Census_Tracts_Updated.shp\"\n",
    "flood_zones_path = \"/Users/jesseandrews/Library/CloudStorage/OneDrive-UniversityofNebraskaatKearney/GIS Projects/FEMA NFHL/Study Area/S_FLD_HAZ_AR_merged.shp\"\n",
    "\n",
    "try:\n",
    "    # Load shapefiles\n",
    "    logging.info(\"Loading shapefiles...\")\n",
    "    census_tracts = gpd.read_file(census_tracts_path)\n",
    "    flood_zones = gpd.read_file(flood_zones_path)\n",
    "\n",
    "    logging.debug(f\"Census tracts shape: {census_tracts.shape}\")\n",
    "    logging.debug(f\"Flood zones shape: {flood_zones.shape}\")\n",
    "\n",
    "    # Check for 'FLD_ZONE' column in flood_zones\n",
    "    if 'FLD_ZONE' not in flood_zones.columns:\n",
    "        logging.error(\"'FLD_ZONE' column not found in flood zones shapefile. Available columns: %s\", flood_zones.columns.tolist())\n",
    "        raise ValueError(\"'FLD_ZONE' column not found in flood zones shapefile\")\n",
    "\n",
    "    # Check and reproject CRS if necessary\n",
    "    target_crs = CRS.from_epsg(32104)  # NAD83 / Nebraska East (meters)\n",
    "\n",
    "    if census_tracts.crs != target_crs:\n",
    "        logging.info(f\"Reprojecting census tracts to {target_crs.name}\")\n",
    "        census_tracts = census_tracts.to_crs(target_crs)\n",
    "\n",
    "    if flood_zones.crs != target_crs:\n",
    "        logging.info(f\"Reprojecting flood zones to {target_crs.name}\")\n",
    "        flood_zones = flood_zones.to_crs(target_crs)\n",
    "\n",
    "    # Check and fix geometries\n",
    "    logging.info(\"Checking and fixing geometries...\")\n",
    "    census_tracts['geometry'] = census_tracts['geometry'].apply(make_valid)\n",
    "    flood_zones['geometry'] = flood_zones['geometry'].apply(make_valid)\n",
    "\n",
    "    # Simplify geometries\n",
    "    logging.info(\"Simplifying geometries...\")\n",
    "    census_tracts['geometry'] = census_tracts.geometry.simplify(tolerance=1)\n",
    "    flood_zones['geometry'] = flood_zones.geometry.simplify(tolerance=1)\n",
    "\n",
    "    # Get unique flood zone types (excluding 'AREA NOT INCLUDED')\n",
    "    flood_zone_types = flood_zones['FLD_ZONE'].unique()\n",
    "    flood_zone_types = [fz for fz in flood_zone_types if fz != 'AREA NOT INCLUDED']\n",
    "    logging.debug(f\"Flood zone types: {flood_zone_types}\")\n",
    "\n",
    "    # Intersect census tracts with flood zones\n",
    "    logging.info(\"Intersecting census tracts with flood zones...\")\n",
    "    intersection = gpd.overlay(census_tracts, flood_zones[['FLD_ZONE', 'geometry']], how='intersection')\n",
    "\n",
    "    # Calculate areas\n",
    "    intersection['intersection_area'] = intersection.geometry.area\n",
    "    census_tracts['total_area'] = census_tracts.geometry.area\n",
    "\n",
    "    # Calculate percentages for each flood zone type\n",
    "    for fz_type in flood_zone_types:\n",
    "        col_name = f\"{fz_type[:8]}_AR\"\n",
    "        fz_areas = intersection[intersection['FLD_ZONE'] == fz_type].groupby('GEOID')['intersection_area'].sum()\n",
    "        census_tracts[col_name] = census_tracts['GEOID'].map(fz_areas) / census_tracts['total_area'] * 100\n",
    "        census_tracts[col_name] = census_tracts[col_name].fillna(0).clip(0, 100).round(2)\n",
    "        \n",
    "        logging.info(f\"{col_name} range: {census_tracts[col_name].min()} to {census_tracts[col_name].max()}\")\n",
    "        \n",
    "        # Log any census tracts with high percentages\n",
    "        high_percentage_tracts = census_tracts[census_tracts[col_name] > 90]\n",
    "        if not high_percentage_tracts.empty:\n",
    "            logging.warning(f\"Census tracts with {col_name} > 90%:\")\n",
    "            for idx, row in high_percentage_tracts.iterrows():\n",
    "                logging.warning(f\"  Tract {row['GEOID']}: {row[col_name]}%\")\n",
    "\n",
    "    # Calculate total flood zone area and percentage\n",
    "    total_fz_areas = intersection.groupby('GEOID')['intersection_area'].sum()\n",
    "    census_tracts['TOTAL_FZ_AR'] = census_tracts['GEOID'].map(total_fz_areas) / census_tracts['total_area'] * 100\n",
    "    census_tracts['TOTAL_FZ_AR'] = census_tracts['TOTAL_FZ_AR'].fillna(0).clip(0, 100).round(2)\n",
    "\n",
    "    logging.info(f\"Total flood zone percentage range: {census_tracts['TOTAL_FZ_AR'].min()} to {census_tracts['TOTAL_FZ_AR'].max()}\")\n",
    "\n",
    "    # Log census tracts with total flood zone percentage > 90%\n",
    "    high_total_fz_tracts = census_tracts[census_tracts['TOTAL_FZ_AR'] > 90]\n",
    "    if not high_total_fz_tracts.empty:\n",
    "        logging.warning(\"Census tracts with total flood zone percentage > 90%:\")\n",
    "        for idx, row in high_total_fz_tracts.iterrows():\n",
    "            logging.warning(f\"  Tract {row['GEOID']}: {row['TOTAL_FZ_AR']}%\")\n",
    "\n",
    "    # Remove temporary columns\n",
    "    census_tracts = census_tracts.drop(columns=['total_area'])\n",
    "\n",
    "    # Save updated census tracts shapefile\n",
    "    logging.info(f\"Saving updated shapefile to {census_tracts_path}\")\n",
    "    census_tracts.to_file(census_tracts_path)\n",
    "\n",
    "    logging.info(\"Processing complete!\")\n",
    "\n",
    "except Exception as e:\n",
    "    logging.exception(\"An error occurred during processing:\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "geo_env",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "name": "python",
   "version": "3.9.19"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
